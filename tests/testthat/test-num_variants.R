test_that("numeric variants", {
  num_vrnts <- c("1234.56", "1,234.56 [e]", "1,234,567", "1,234,567.89",
                 "-12", "(12)", "12%", "-12.345", "(12.345) [e]", "12.345%")
  sh_nv <- shrthnd_num(num_vrnts)
  shrthnd_num(num_vrnts)
  expect_equal(
    as.numeric(shrthnd_num(num_vrnts)),
    c(1234.56, 1234.56, 1234567, 1234567.89, -12, -12, 12, -12.345,
      -12.345, 12.345)
  )
  expect_equal(
    as.numeric(sh_nv, paren_nums = "strip"),
    c(1234.56, 1234.56, 1234567, 1234567.89, -12, -12, 12, -12.345,
      -12.345, 12.345)
  )
})

test_vec <- c(
  "12",
  "12.34",
  "12,345",
  "12,345.678",
  "1,234,567",
  "1,234,567.90",
  "-12",
  "-12.34",
  "-12,345",
  "-12,345.678",
  "-1,234,567",
  "-1,234,567.90",
  "12[e]",
  "12.34[e]",
  "12,345[e]",
  "12,345.678[e]",
  "1,234,567[e]",
  "1,234,567.90[e]",
  "-12[e]",
  "-12.34[e]",
  "-12,345[e]",
  "-12,345.678[e]",
  "-1,234,567[e]",
  "-1,234,567.90[e]",
  "12*",
  "12.34*",
  "12,345*",
  "12,345.678*",
  "1,234,567*",
  "1,234,567.90*",
  "-12*",
  "-12.34*",
  "-12,345*",
  "-12,345.678*",
  "-1,234,567*",
  "-1,234,567.90*",
  "(12)*",
  "(12.34)*",
  "(12,345)*",
  "(12,345.678)*",
  "(1,234,567)*",
  "(1,234,567.90)*",
  "[c]",
  "NA",
  NA_character_
)

test_that("lots of number variants", {
  expect_equal(
    convert_to_num(test_vec, shorthand = c("[c]", "[e]", "*"),
                   paren_nums = "negative"),
    c(
      12,
      12.34,
      12345,
      12345.678,
      1234567,
      1234567.9,
      -12,
      -12.34,
      -12345,
      -12345.678,
      -1234567,
      -1234567.9,
      12,
      12.34,
      12345,
      12345.678,
      1234567,
      1234567.9,
      -12,
      -12.34,
      -12345,
      -12345.678,
      -1234567,
      -1234567.9,
      12,
      12.34,
      12345,
      12345.678,
      1234567,
      1234567.9,
      -12,
      -12.34,
      -12345,
      -12345.678,
      -1234567,
      -1234567.9,
      -12,
      -12.34,
      -12345,
      -12345.678,
      -1234567,
      -1234567.9,
      NA,
      NA,
      NA
      )
  )
})
