<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="shrthnd">
<title>Numeric vectors with tags â€¢ shrthnd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Heebo-0.4.6/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.6/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Numeric vectors with tags">
<meta property="og:description" content="shrthnd">
<meta property="og:image" content="https://mattkerlogue.github.io/shrthnd/reference/figures/shrthnd_hex.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">shrthnd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/shrthnd-num.html">Numeric vectors with tags</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mattkerlogue/shrthnd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Numeric vectors with tags</h1>
                        <h4 data-toc-skip class="author">Matt
Kerlogue</h4>
            
            <h4 data-toc-skip class="date">2023-05-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mattkerlogue/shrthnd/blob/HEAD/vignettes/shrthnd-num.Rmd" class="external-link"><code>vignettes/shrthnd-num.Rmd</code></a></small>
      <div class="d-none name"><code>shrthnd-num.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mattkerlogue/shrthnd" class="external-link">shrthnd</a></span><span class="op">)</span></span></code></pre></div>
<p>The development of the <a href="https://github.com/mattkerlogue/shrthnd" class="external-link">shrthnd</a> package is heavily
influenced by experience of working with statistical datasets published
by governments and international bodies, especially departments and
agencies in the UK producing outputs as part of the <a href="https://www.statisticsauthority.gov.uk" class="external-link">UK statistical
system</a>.</p>
<p>While data is increasingly released in machine readable formats or
through APIs, there are still a large number of data products that
continue to be released in spreadsheets and historical data from these
institutions is often only available in spreadsheets. Beyond layout
issues, such as the use of header and footer rows to communicate related
information, it is not uncommon to encounter columns in these
spreadsheets that contain a mix of numeric and non-numeric content. This
non-numeric content may sometimes be the only content of a cell (to
explain why there is no numeric value) or alongside a numeric value (to
qualify, caveat or otherwise explain something about the value).</p>
<p>The most common approach in data processing when encountering these
sorts of issues is simply to scrub the vector of the non-numeric
components and coerced it into a numeric vector. However, these tags
often convey useful information which you may wish to retain.</p>
<div class="section level2">
<h2 id="introducing-shrthnd_num">Introducing <code>shrthnd_num()</code><a class="anchor" aria-label="anchor" href="#introducing-shrthnd_num"></a>
</h2>
<p>The <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> data type builds on
<code><a href="https://vctrs.r-lib.org/reference/new_rcrd.html" class="external-link">vctrs::new_rcrd()</a></code> to split numeric and non-numeric
components while keeping them attached to each other. In practice a
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> can be thought of as a <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>
and <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> vector that have been coupled together.
Specifically it has a <code>num</code> component representing the
numeric value and a <code>tag</code> component representing the
non-numeric shorthand, symbol or marker.</p>
<p>Let us create the vector <code>x</code> with seven values:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"12"</span>, <span class="st">"34.567"</span>, <span class="st">"[c]"</span>, <span class="st">"NA"</span>, <span class="st">"56.78[e]"</span>, <span class="st">"78.9"</span>, <span class="st">"90.123[e]"</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; [1] "12"        "34.567"    "[c]"       "NA"        "56.78[e]"  "78.9"     </span></span>
<span><span class="co">#&gt; [7] "90.123[e]"</span></span></code></pre></div>
<p>The first, second and sixth values in this vector are purely numeric
(<code>12</code>, <code>34.567</code> and <code>78.9</code>). The third
value is a shorthand symbol (<code>"[c]"</code>) denoting that the value
has been suppressed because it is confidential. The fourth value is a
missing value (<code>"NA"</code>). The fifth and seventh values contain
both numeric information (<code>56.78</code> and <code>90.123</code>
respectively) but also shorthand (<code>"[e]"</code>) to denote that
these values are estimated. Depending on what processing we wish to do
with this vector in the future it might be useful to know that a value
has been suppressed or estimated.</p>
<p>Using <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric()</a></code> on this vector will result in all of
the values containing any non-numeric element to be converted to a
missing value, causing us to lose all the information of the third,
fifth and seventh values in the vector.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: NAs introduced by coercion</span></span>
<span><span class="co">#&gt; [1] 12.000 34.567     NA     NA     NA 78.900     NA</span></span></code></pre></div>
<p>We could scrub the non-numeric elements of the vector, but we still
lose the information provided by the shorthand.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[^0-9.]"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12.000 34.567     NA     NA 56.780 78.900 90.123</span></span></code></pre></div>
<p>The <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> function, however, allows us to retain
both sets of information, and we can easily coerce a
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> vector into a regular base R
<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> vector. We can also easily access the shorthand
or symbol tags with the <code><a href="../reference/shrthnd_tags.html">shrthnd_tags()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sh_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shrthnd_num.html">shrthnd_num</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sh_x</span></span>
<span><span class="co">#&gt; &lt;shrthnd_num[7]&gt;</span></span>
<span><span class="co">#&gt; [1] 12.00    34.57    [c]      &lt;NA&gt;     56.78[e] 78.90    90.12[e]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12.000 34.567     NA     NA 56.780 78.900 90.123</span></span>
<span></span>
<span><span class="fu"><a href="../reference/shrthnd_tags.html">shrthnd_tags</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA    NA    "[c]" NA    "[e]" NA    "[e]"</span></span></code></pre></div>
<p>The <code><a href="../reference/shrthnd_list.html">shrthnd_list()</a></code> function provides a summary of the
tags contained in a <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> vector, their frequency
and positions in the vector.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/shrthnd_list.html">shrthnd_list</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;shrthnd_list[2]&gt;</span></span>
<span><span class="co">#&gt; [c] <span style="color: #949494;">(1 location)</span>: 3 </span></span>
<span><span class="co">#&gt; [e] <span style="color: #949494;">(2 locations)</span>: 5, 7</span></span></code></pre></div>
<p>We saw above how <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric()</a></code> converts a
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> to a numeric vector,
<code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code> will similarly convert a
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> to a character vector as if it were a numeric
vector. Instead to print a character vector that combines the numeric
and non-numeric components we can use <code><a href="../reference/as_shrthnd.html">as_shrthnd()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "12"     "34.567" NA       NA       "56.78"  "78.9"   "90.123"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/as_shrthnd.html">as_shrthnd</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "12.00"    "34.57"    "[c]"      NA         "56.78[e]" "78.90"    "90.12[e]"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="making-a-shrthnd_num">Making a shrthnd_num<a class="anchor" aria-label="anchor" href="#making-a-shrthnd_num"></a>
</h2>
<p>You can make a <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> vector in two ways: using
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> to convert a character vector containing
numeric and non-numeric components, or <code><a href="../reference/make_shrthnd_num.html">make_shrthnd_num()</a></code>
to merge a vector of numbers and a vector of character strings.</p>
<div class="section level3">
<h3 id="conversion-to-a-shrthnd_num">Conversion to a shrthnd_num<a class="anchor" aria-label="anchor" href="#conversion-to-a-shrthnd_num"></a>
</h3>
<p>You convert a character vector containing shorthand using
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code>. In addition to the character vector you can
also supply additional arguments to control the behaviour of the
conversion and the resulting display of the vector.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/shrthnd_num.html">shrthnd_num</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  shorthand <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na_values <span class="op">=</span> <span class="st">"NA"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  paren_nums <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"negative"</span>, <span class="st">"strip"</span><span class="op">)</span>,</span>
<span>  dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  bigmark <span class="op">=</span> <span class="st">","</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;shrthnd_num[7]&gt;</span></span>
<span><span class="co">#&gt; [1] 12.00    34.57    [c]      &lt;NA&gt;     56.78[e] 78.90    90.12[e]</span></span></code></pre></div>
<p>The <code>shorthand</code> argument allows you to pass a character
vector of shorthand, symbols and markers that you want to validate
against, i.e.Â you can cause the conversion to throw an error if it
detects shorthand that is not in this vector.</p>
<p>The <code>na_values</code> argument is used to determine values that
should be ignored when identifying shorthand tags and converted to
missing values when extracting the numeric component.</p>
<p>The <code>digits</code>, <code>dec</code> and <code>bigmark</code>
arguments are passed on to <code><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC()</a></code> in the formatting of
the numeric component when formatting and printing the vector.</p>
<p>The <code>paren_nums</code> argument determines how to handle numbers
in parenthesis, i.e. whether to consider a number in parenthesis as a
negative number (as is commonly used in accounting formats, and the
default setting) or whether to just strip the parenthesis from the
number before its conversion.</p>
<p>The coercion to a <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> vector is handled by
<code><a href="https://rdrr.io/r/utils/type.convert.html" class="external-link">utils::type.convert()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="making-a-shrthnd_num-from-scratch">Making a shrthnd_num from scratch<a class="anchor" aria-label="anchor" href="#making-a-shrthnd_num-from-scratch"></a>
</h3>
<p>You can use <code><a href="../reference/make_shrthnd_num.html">make_shrthnd_num()</a></code> to create a
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> from a <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> and
<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> vector of the same length.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_shrthnd_num.html">make_shrthnd_num</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="cn">NA</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"[c]"</span>, <span class="st">""</span>, <span class="st">"[e]"</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;shrthnd_num[7]&gt;</span></span>
<span><span class="co">#&gt; [1] 1    2    3    [c]  4    5[e] &lt;NA&gt;</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="coercion-maths-and-statistics">Coercion, maths and statistics<a class="anchor" aria-label="anchor" href="#coercion-maths-and-statistics"></a>
</h2>
<p>Generally a <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> should behave like a
<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> vector. For example, using <code><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na()</a></code>
will return <code>TRUE</code> where the numeric value is missing and
<code>FALSE</code> where the numeric value is not missing. Or, if you
use <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> to combine a <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> with
another vector it will first coerce the vector to numeric so that R can
proceed from there.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sh_x</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12.000 34.567     NA     NA 56.780 78.900 90.123  1.000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sh_x</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "12"     "34.567" NA       NA       "56.78"  "78.9"   "90.123" "c"</span></span></code></pre></div>
<p>However, in keeping with base R practice around complex numeric
objects such as <code>Date()</code>, <code><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime()</a></code> and
<code>POSIXct()</code>, using <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric()</a></code> on a
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> vector will return <code>FALSE</code>. Use
<code><a href="../reference/is_shrthnd.html">is_shrthnd_num()</a></code> to test if a vector is a
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> vector.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/is_shrthnd.html">is_shrthnd_num</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Through <code><a href="https://vctrs.r-lib.org/reference/vec_arith.html" class="external-link">vctrs::vec_arith()</a></code> and
<code><a href="https://vctrs.r-lib.org/reference/vec_math.html" class="external-link">vctrs::vec_math()</a></code> there is generalised support for
arithmetic and mathematical operations on a <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code>
vector. Bespoke methods have also been added for some functions which
are not directly supported, such as <code><a href="https://rdrr.io/r/stats/median.html" class="external-link">median()</a></code> and
<code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code>, so that they can easily work with the numeric
components of the <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> vector.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"12"</span>, <span class="st">"34.567"</span>, <span class="st">"[c]"</span>, <span class="st">"NA"</span>, <span class="st">"56.78[e]"</span>, <span class="st">"78.9"</span>, <span class="st">"90.123[e]"</span><span class="op">)</span></span>
<span><span class="va">sh_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shrthnd_num.html">shrthnd_num</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"[c]"</span>, <span class="st">"[e]"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sh_x</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="co">#&gt; [1]  24.000  69.134      NA      NA 113.560 157.800 180.246</span></span>
<span></span>
<span><span class="fl">2</span> <span class="op">+</span> <span class="va">sh_x</span></span>
<span><span class="co">#&gt; [1] 14.000 36.567     NA     NA 58.780 80.900 92.123</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sh_x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 272.37</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">sh_x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12.000 90.123</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sh_x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 54.474</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-shrthnd-tags">Working with shrthnd tags<a class="anchor" aria-label="anchor" href="#working-with-shrthnd-tags"></a>
</h2>
<p>The <code><a href="../reference/shrthnd_tags.html">shrthnd_tags()</a></code> function allows us to access the tag
components of a <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code>. It has a related function
<code><a href="../reference/shrthnd_tags.html">shrthnd_unique_tags()</a></code> which will return a unique list of
tags, and is simply a convenience function in place of
<code>unique(shrthnd_tags(x))</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/shrthnd_tags.html">shrthnd_tags</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] NA    NA    "[c]" NA    "[e]" NA    "[e]"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/shrthnd_tags.html">shrthnd_unique_tags</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "[c]" "[e]"</span></span></code></pre></div>
<p>The base R functions for value matching work with the numeric
component of a <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> vector. Separate tag locator
functions have been used to support matching the tag components of a
<code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> vector.</p>
<p><code><a href="../reference/tag_locations.html">tag_match()</a></code> returns an integer vector showing the first
location of the tag provided while <code><a href="../reference/tag_locations.html">tag_in()</a></code> will return
<code>TRUE</code> or <code>FALSE</code> depending on whether the tag is
in the vectorâ€™s shorthand.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tag_locations.html">tag_match</a></span><span class="op">(</span><span class="va">sh_x</span>, <span class="st">"[e]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tag_locations.html">tag_in</a></span><span class="op">(</span><span class="va">sh_x</span>, <span class="st">"[e]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>To locate where a specific tag is used in a vector use
<code><a href="../reference/tag_locations.html">where_tag()</a></code>, which is equivalent to computing
<code>tags == tag</code>. To identify if a value has a tag, irrespective
of its value use <code><a href="../reference/tag_locations.html">any_tag()</a></code>, which is equivalent to
<code>!is.na(tags)</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tag_locations.html">where_tag</a></span><span class="op">(</span><span class="va">sh_x</span>, <span class="st">"[e]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]    NA    NA FALSE    NA  TRUE    NA  TRUE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tag_locations.html">any_tag</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE  TRUE FALSE  TRUE FALSE  TRUE</span></span></code></pre></div>
<p>Using <code><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na()</a></code> on a <code><a href="../reference/shrthnd_num.html">shrthnd_num()</a></code> will
assess if the numeric component is missing. To identify if tags are
missing use <code><a href="../reference/tag_locations.html">is_na_tag()</a></code>, which is equivalent to
<code>is.na(tags)</code>. To identify if both the numeric and tag
component is missing use <code><a href="../reference/tag_locations.html">is_na_both()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tag_locations.html">is_na_tag</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tag_locations.html">is_na_both</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</span></span></code></pre></div>
<p>Finally, you can locate the positions of a specific tag, tagged
values or untagged values using a set of <code>locate_*()</code>
functions, which are convenience functions wrapping the functions that
return logical vectors in <code><a href="https://rdrr.io/r/base/which.html" class="external-link">which()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tag_locations.html">locate_tag</a></span><span class="op">(</span><span class="va">sh_x</span>, <span class="st">"[e]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5 7</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tag_locations.html">locate_any_tag</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3 5 7</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tag_locations.html">locate_no_tag</a></span><span class="op">(</span><span class="va">sh_x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 4 6</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Kerlogue.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
